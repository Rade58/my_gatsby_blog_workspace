# DAKLE `MDXRenderer`, KADA SE DOGODI RERENDER KOMPONENTE USTVARI PRAVI NOVE ELEMENTE

***

A POSTO SAM PROKLJUVIO KASNIJE I POCEO DA KORISTIM `IntersectionObserver` U `packages/gatsby-theme-raedal/src/components/mdx-theme-ui-overrides/heading.tsx` KOMPONENTI, MOZDA SAM MOGAO OVAJ BRANCH DA NAZOVEM DRUGACIJE, ALI NEMA VEZE SVE JE U REDU

***

OVO JE PROBLEM JER `VISE NE POSTOJE ELEMENTI KOJE OBSERVE-UJEM SA INTERSECTION OBSERVER-OM`

**NAIME PRAVE SE NOVI ELEMENTI I INTERSECTION OBSERVER JE USELES, JER ONI HEDING DIV-OVI KOJE OBSERVE-UJEM NISU VISE MOUNTED**

IMAM PAR IDEJA KAKO OVO DA OVERCOME-UJEM

- MOGU DA IPAK KORISTIM DISPATCHING, ALI FROM ARTICLE COMPONENT

NE BIH VISE FORWARD-OVAO REFERENCU ARTICLE-A, ALI BIH ID-JEVE SVIH HEADER-A POSLAO U REDUCER STATE

STO SE TICE RERENDERINGA MDXRenderer-A O TOME BIH VODIO RACUNA STO BIH UVEK ON MOUNTING OPET ACCESS-OVAO NOVIM HEADING DIV-OVIMA, I ONDA OPET USPOSTAVLJAO OBSERVER-A U `useEffect` HOOK-U

# :one: ZA POCETAK UKLANJAM REF FORWARDING IZ ARTICLE-A

I UKLANJAM SVA MESTA GDE SAM KORISTIO TAJ REF, IMA IH NEKOLIKO, A TAKODJE I MORAM DA REDEFINISEM TZPESCRIPT INTERFACE-OVE PROPS, N NEKIM KOMPONENTAMA

# :two: UKLONIO SAM SVU LOGIKU INTERSECTION OBSERVER-A IZ JUMPER KOMPONENTE

CISTO TI SAMO NAPOMINJEM DA JAUMPER KOMPONENTA JESTE I DALJE KOMPONENTA, KOJA IMA TABLE OF HEADINGS

# :three: I PALO MI JE NA PAMET DA JA USTVARI IMAM `packages/gatsby-theme-raedal/src/components/mdx-theme-ui-overrides/heading.tsx`; I MOZDA MOGU ODANDE DA UZMEM NEKU LOGIKU

PA JA MOGU DA UPOTREBIM TAMO INTERSECTION OBSERVER

`JA UPRAVO ODANDE MOGU DISPATCH-OVATI DA LI JE CURRENT HEADING INTERSECTED SA VIEWPORTOM`

# :four: IGRACU SE MALO SA INTERSECTION OBSERVEROM, KOJEG CU DEFINISATI ZA HEADING, PA CU ONDA VIDETI STA BI TREBAL ODA DISPATCH-UJEM

USPESN OSAM GA USPOSTAVIO ON MOUNTING, U POMENUTOJ KOMPONENTI, SADA SAMO DA GA MALO ISPROBAM

CITACU STA MI TO SVE NUDE INFORMACIJE IZ OBIMA OBSERVER-OVOG CALLBACK-A, PA CU VIDETI STA MI JE OD TOGA KORISNO

# :five: PROSIRUJEM REDUCER STATE, KOJI TREBA DA HOLD-UJE ID TRENUTNOG INTERSECTED DIV-A (TO SAM VEC JEDNOM URADIO PA COMMENT-OVAO CODE, SADA CU SAM OTO DA ODCOMMENT-UJEM)

# :six: KORISTIM POMENUTI STATE INSIDE `packages/gatsby-theme-raedal/src/components/jumper-h.tsx`

I STATE SE USPENO MENJA

# !!!! ALI OPET IMAM PROBLEM KOJI JE TAKAV SIGURNO ZBOG RERENDERING-A `MDXRenderer`-A ,ONDONO ONOGO STA DOLAZI IZ body-JA MDX FAJLA !!!!

STO MI GOVORI DA NEMA SANSE DA KORISTIM HASHEVE, ODNONO TARGET LINKOVE JER DODAVANJE ID-JA URI-JU IZAZIVA ENDLESS LOOP

UZASNO, ZATO CU IPAK MORATI DA DEFINISEM SVE KORISCENJEM JAVASCRIPTA

# !!!! MORAM REDEFINISATI `packages/gatsby-theme-raedal/src/components/mdx-theme-ui-overrides/heading.tsx` U POTPUNOSTI (**NE MORAM JER SAM USPEO DA RESIM PROBLEM**)

***
***

# USPEO SAM DA RESIM POMENUTI PROBLEM TAK OSTO NISAM MENJAO REDUCER-OV STATE; I NE MORAM DA REDEFINISEM NISTA U POTPUNOSTI, JER JE SVE U REDU; A EVO KAK OSAM REIO PROBLEM

- IMAM LOKANI STATE U `packages/gatsby-theme-raedal/src/components/jumper-h.tsx`

- I IMAM RELATED SET STATE FUNKCIJU, ZA TAJ STATE

- I ON MOUNTING, JA UPRAVO DISPATCH-UJEM TU FUNKCIJU I NJU SKLADISTI MKAO GRANU REDUCER STATE-A

- I UPRAVO TA FUNKCIJA ZAVRSAVA U `packages/gatsby-theme-raedal/src/components/mdx-theme-ui-overrides/heading.tsx`

- U KOJOJ SAM PODESIO INTERSECTION OBSERVER-A

- I UPRAVO POZIVAM TAMO, POMENUTU JAUMPER-OVU SET STATE FUNKCIJU 

NA TAJ NACIN RERENDER-UJE SE SAMO JUMPER

**I TAK OSAM IZBEGAO NESNOSNI RERENDERING MDX-OVOG BODY-JA, KOJI SE DOGADJA KADA KORISTIM REDUCER-OV STATE, ODNONO KADA SAM TRENUTNI ID, ODNONO ID INTERSECTED ELEMENTE SKALDISTIO KAO STATE U REDUCER STORE-U**

***
***

# TREBAO BI SADA DA DEFINISEM MOZDA DA SETUJEM POMENUTI STATE, SAMO KADA JE HEADING ODOZGO 20% PROCENATA USAO U VIEWPORT ODNONO ONDA KADA JE 20% ODOZDO (AKO IDE ODOZDO), USAO U VIEWPORT, JER TAKO CU IMATI NEKU BOLJU SITUACIJU

ODNONO NE ZELIM DA SE JUMPER-OV STATE SET-UJE ONDA KADA JE IVICA ROOT-A DODAIRNULA IVICU HEADING DIV-A, JER NE BI IZGLEDALO PRIRODNO ONOME KOJI SCROLL-UJE STRANICU (BAR TAKO MISLIM)

**POTREBNO JE SAMO OPTIONS `rootMargin` PODESITI NA PRIMER NA `-20%`**

ALI IPAK OVO NECE VALJATI ZA SLUCAJ KADA SE KLIKNE NA NASLOV

JER AKO NASLOV DOLAZI U VIEWPORT, ODOZGO, TADA SE NECE PROMENITI STATE, JER SE NECE DESITI INTERSECTION

**JER TADA HEADING DIV NIJE STIGAO DO MESTA VIEWPORTA KOJE -20% MARGIN**

# KAO RESENJE POMENUTOG PROBLEMA, MOGAO BIH DA ZAKACIM HANDLE-RE, ALI TO BIH MORAO RADITI I U `packages/gatsby-theme-raedal/src/components/jumper-h.tsx` KOMPONENTI, ALI I U `packages/gatsby-theme-raedal/src/components/mdx-theme-ui-overrides/heading.tsx`

- U PRVOJ KOMPONENTI, HANDLER, BI SE NALAZIO NA HEADING-U (ODNONO ANCHOR-U)

- U DRUGOJ KOMPONENTI HANDLER BI ZAKACIO NA HEADING DIV

AKO IMAS DILEMU U POGLEDU SLEDECEG, TREBA DA ZNAS

**`DA TI MOZES KACITI HANDLERE NA Link KOMPONENTU`**

# DEFINISAO SAM I HIGHLIGHTING ONIH NASLOVA U `TABLE OF CONTENT` SEKCIJI JUMPER KOMPONENTE

ALI IMAM JEDAN PROBLEM, KOJI SE OGLEDA U TOME

!!!!

**`KADA U VIEWPORT-U STANU DVA NASLOVA, INTERSECTION OBSERVER PROMENI STATE I 'TRENUTNI TARGETED HASHED HEADING' NIJE HIGHLIGHTED, VEC ONO STO JE PROMENA JUMPER-OVOG STATE-A U  INTERSECTION-U NAKNADNO HIGHLIGHTED`**

*OVO MOZDA NIJE VELIKI PROBLEM, MOZDA BI GA TREBALO **`IGNORISATI`***

ZATO STO VEROVATNO

**NECU U MDX FAJLU IMATI GUSTO ORIJENTISANE `h2` ELEMENTE, ODNONO NASLOVE SA DVA HASH-A `##`**

DAKLE AKO ZELIM MNOGO NASLOVA KORISTICU h3 KOJI JE NE HIGHLIGHT-UJU I TO CE RESITI PROBLEM
